# Trivy Ignore List for Backend Docker Image
# These CVEs are in the gcr.io/distroless/python3-debian12 base image
# and have no fixes available. They are not in our application code or dependencies.

# CVE-2025-8194 (HIGH)
# Package: libpython3.11-minimal, libpython3.11-stdlib, python3.11-minimal
# Issue: CPython infinite loop when parsing a tarfile
# Status: affected (no fix available)
# Impact: Base Python 3.11 packages in Debian 12
CVE-2025-8194

# CVE-2025-7458 (CRITICAL)
# Package: libsqlite3-0
# Issue: SQLite integer overflow
# Status: affected (no fix available)
# Impact: System SQLite library in Debian 12
CVE-2025-7458

# CVE-2023-45853 (CRITICAL)
# Package: zlib1g
# Issue: Integer overflow and heap-based buffer overflow in zipOpenNewFileInZip4_6
# Status: will_not_fix (Debian has decided not to fix this)
# Impact: System zlib compression library in Debian 12
CVE-2023-45853

# ============================================================================
# MEDIUM Severity - Base Image Vulnerabilities
# Temporarily ignored until Google updates Distroless Python base image
# Review monthly: Check if Python 3.11 patches are available in Debian 12
# ============================================================================

# CVE-2025-8291 (MEDIUM)
# Package: libpython3.11-minimal, python3.11-minimal
# Issue: Python zipfile End of Central Directory (EOCD) Locator record offset issue
# Status: affected (awaiting upstream Python/Debian patch)
# Impact: Base Python 3.11 packages in Debian 12
# Note: Requires malicious zipfile input to exploit
CVE-2025-8291

# CVE-2025-4516 (MEDIUM)
# Package: python3.11-minimal
# Issue: CPython DecodeError Handling Vulnerability
# Status: affected (awaiting upstream Python/Debian patch)
# Impact: Base Python 3.11 packages in Debian 12
CVE-2025-4516

# CVE-2025-6069 (MEDIUM)
# Package: python3.11-minimal
# Issue: Python HTMLParser quadratic complexity
# Status: affected (awaiting upstream Python/Debian patch)
# Impact: Base Python 3.11 packages in Debian 12
# Note: DoS risk only with large, malicious HTML input
CVE-2025-6069

# CVE-2025-6075 (MEDIUM)
# Package: python3.11-minimal
# Issue: Quadratic complexity in os.path.expandvars() with user-controlled template
# Status: affected (awaiting upstream Python/Debian patch)
# Impact: Base Python 3.11 packages in Debian 12
# Note: DoS risk only with user-controlled path expansion
CVE-2025-6075

# CVE-2025-7709 (MEDIUM)
# Package: libsqlite3-0
# Issue: Integer overflow exists in the FTS5 extension
# Status: affected (awaiting upstream SQLite/Debian patch)
# Impact: System SQLite library in Debian 12
# Note: Requires FTS5 full-text search usage to exploit
CVE-2025-7709

# CVE-2023-50495 (MEDIUM)
# Package: libtinfo6
# Issue: ncurses segmentation fault via _nc_wrap_entry()
# Status: affected (awaiting Debian patch)
# Impact: System ncurses library in Debian 12
# Note: Low risk - requires specific ncurses terminal manipulation
CVE-2023-50495

# CVE-2025-59375 (MEDIUM)
# Package: libexpat1
# Issue: libexpat allows attackers to trigger large dynamic memory allocations
# Status: will_not_fix (Debian has decided not to fix this)
# Impact: System XML parser library in Debian 12
# Note: DoS risk requiring malicious XML input
CVE-2025-59375

# ============================================================================
# PAM (Pluggable Authentication Modules) Vulnerabilities
# Base OS authentication libraries - awaiting Debian upstream fixes
# ============================================================================

# CVE-2025-6020 (HIGH)
# Package: libpam-modules, libpam-modules-bin, libpam-runtime, libpam0g
# Issue: Linux-pam directory traversal vulnerability
# Status: affected (awaiting Debian patch)
# Impact: System PAM libraries in Debian 12
# Note: Affects authentication system, but requires local access
CVE-2025-6020

# CVE-2024-10041 (MEDIUM)
# Package: libpam-modules, libpam-modules-bin, libpam-runtime, libpam0g
# Issue: libpam vulnerable to read hashed password
# Status: will_not_fix (design limitation)
# Impact: System PAM libraries in Debian 12
CVE-2024-10041

# CVE-2024-22365 (MEDIUM)
# Package: libpam-modules, libpam-modules-bin, libpam-runtime, libpam0g
# Issue: Allows unprivileged user to block another user namespace
# Status: affected (awaiting Debian patch)
# Impact: System PAM libraries in Debian 12
# Note: Requires local user access to exploit
CVE-2024-22365

# ============================================================================
# GnuPG Vulnerabilities
# Base OS package management tools - awaiting Debian upstream fixes
# ============================================================================

# CVE-2025-30258 (MEDIUM)
# Package: gpgv
# Issue: Verification DoS due to malicious subkey in keyring
# Status: affected (awaiting Debian patch)
# Impact: GPG verification tool in Debian 12
# Note: DoS only, requires malicious keyring - low risk for containerized apps
CVE-2025-30258

# ============================================================================
# Node.js/npm Vulnerabilities (Base Image)
# These are in the Python base image's system packages, not our application
# ============================================================================

# CVE-2025-13466 (MEDIUM)
# Package: body-parser (in npm bundled with Python base image)
# Issue: body-parser 2.2.0 vulnerable to DoS due to inefficient processing
# Status: fixed in body-parser 2.2.1+
# Impact: npm's bundled body-parser in Python base image
# Context: Python slim images include npm as a system package
#          This backend is Python-only and does not use Node.js/npm/body-parser
#          The vulnerability is not exploitable in this application
# Note: False positive - we don't use npm or body-parser in Python backend
CVE-2025-13466
